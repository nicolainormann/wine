var WineApp;!function(WineApp){function WineConfig($stateProvider,$urlRouterProvider,$locationProvider){$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode(!0),$stateProvider.state("search",{url:"/",templateUrl:"/assets/ts/components/wine/view/search.html"}).state("list",{url:"/list",templateUrl:"/assets/ts/components/wine/view/list.html"}).state("detail",{url:"/detail/:id",templateUrl:"/assets/ts/components/wine/view/detail.html",controller:"DetailCtrl",controllerAs:"detail",resolve:{details:function(service,$stateParams){return service.getCurrentProduct($stateParams.id)}}}).state("edit",{url:"/detail/:id/edit",templateUrl:"/assets/ts/components/wine/view/edit.html"})}WineApp.WineConfig=WineConfig}(WineApp||(WineApp={}));var WineApp;!function(WineApp){angular.module("app",["ui.router","wine"]).config(WineApp.WineConfig)}(WineApp||(WineApp={})),angular.module("wine",[]),angular.module("wine").controller("DetailCtrl",function(details){this.product=details}),angular.module("wine").controller("ListCtrl",function(service){this.list=service.list}),angular.module("wine").controller("SearchCtrl",function(service,$q,$http){var _this=this;this.searchQuery=null,this.apiKey="9abd6256d560e9392d129425afe7eee9",this.service="http://services.wine.com/api/beta2/service.svc/json/catalog",this.products,this.list=service.list,this.total,this.filter,this.showSearchResult=!1,this.offset=10,this.filterOptions={Appellation:{Name:""},Vineyard:{Name:""}},this.sortOptions={options:{Name:"Name",Vineyard:"Vineyard.Name",Appellation:"Appellation.Name",Price:"PriceRetail"},reverse:!1,currentSort:"Name"},this.updateProductSearch=function(){service.get(_this.service+"?search="+_this.searchQuery+"&apikey="+_this.apiKey,$http,$q,"json").then(function(data){_this.products=[];var listData=data[Object.keys(data)[1]].List;listData.forEach(function(item){_this.products.push(item)}),_this.total=data[Object.keys(data)[1]].Total,_this.filter=service.filterFromJson(_this.products),_this.showSearchResult=!0})},this.addProductToList=function(product){service.addProductToList(product)},this.isProductOnList=function(product){var ids=[];return _this.list.forEach(function(item){ids.push(item.Id)}),-1!==ids.indexOf(product.Id)},this.loadMoreProducts=function(){service.get(_this.service+"?search="+_this.searchQuery+"&offset="+_this.offset+"&apikey="+_this.apiKey,$http,$q,"json").then(function(data){var listData=data[Object.keys(data)[1]].List;listData.forEach(function(item){_this.products.push(item)}),_this.filter=service.filterFromJson(_this.products),_this.offset+=10})},this.setFilter=function(key,value){_this.filterOptions[key].Name==value?_this.filterOptions[key].Name="":_this.filterOptions[key].Name=value},this.isFilterActive=function(key,value){return _this.filterOptions[key].Name==value},this.setSort=function(value){_this.sortOptions.currentSort=value},this.isSortActive=function(value){return _this.sortOptions.currentSort==value},this.setSortReverse=function(value){_this.sortOptions.reverse=value}}),angular.module("wine").component("product",{controller:function(){},template:'<div class="search__product" ng-class="{\'active\': $ctrl.search.isProductOnList($ctrl.product)}">\n                    <div class="row">\n                        <div class="col-md-2 col-sm-2 col-xs-2 search__product_img">\n                            <img src="{{$ctrl.product.Vineyard.ImageUrl}}" class="img-responsive" />\n                        </div>\n\n                        <div class="col-md-6 col-sm-6 col-xs-6 search__product_details">\n                            <div class="row">\n                                <div class="col-md-6 col-sm-6 col-xs-6">\n                                    <b>Product Name:</b>\n                                </div>\n\n                                <div class="col-md-6 col-sm-6 col-xs-6 text-right">\n                                    {{$ctrl.product.Name}}\n                                </div>\n                            </div>\n\n                            <div class="row">\n                                <div class="col-md-6 col-sm-6 col-xs-6">\n                                    <b>Vineyard:</b>\n                                </div>\n\n                                <div class="col-md-6 col-sm-6 col-xs-6 text-right">\n                                    {{$ctrl.product.Vineyard.Name}}\n                                </div>\n                            </div>\n\n                            <div class="row">\n                                <div class="col-md-6 col-sm-6 col-xs-6">\n                                    <b>Appellation:</b>\n                                </div>\n\n                                <div class="col-md-6 col-sm-6 col-xs-6 text-right">\n                                    {{$ctrl.product.Appellation.Name}}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="col-md-3 col-sm-3 col-xs-3 search__product_price text-right">\n                            <b>{{$ctrl.product.PriceRetail}}$</b>\n                        </div>\n\n                        <div class="col-md-1 col-sm-1 col-xs-1 search__product_addtolist" ng-click="$ctrl.search.addProductToList($ctrl.product)">\n                        </div>\n                    </div>\n                </div>',bindings:{product:"=",search:"="}}),angular.module("wine").directive("hest",function(){return{restrict:"A",controller:function($element){console.log($element)}}}),angular.module("wine").service("service",function(){var _this=this;this.list=[],this.get=function(url,$http,$q,responseType){var defer=$q.defer();return $http.get(url,{responseType:responseType?responseType:"json"}).then(function(response){defer.resolve(response.data)},function(reason){defer.reject(reason)}),defer.promise},this.addProductToList=function(product){_this.list.push(product)},this.getCurrentProduct=function(currentId){var product=_this.list.filter(function(item){return item.Id==currentId});return product.pop()},this.filterFromJson=function(json){var filter={},appellation=[],vineyard=[];return json.forEach(function(item){appellation.indexOf(item.Appellation.Name)<0&&appellation.push(item.Appellation.Name),vineyard.indexOf(item.Vineyard.Name)<0&&vineyard.push(item.Vineyard.Name)}),filter.Appellation=appellation,filter.Vineyard=vineyard,filter}});
//# sourceMappingURL=map/main.min.js.map
