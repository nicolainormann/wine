var WineApp;!function(WineApp){function WineConfig($stateProvider,$urlRouterProvider,$locationProvider){$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode(!0),$stateProvider.state("search",{url:"/",templateUrl:"/assets/ts/components/wine/view/search.html"}).state("list",{url:"/list",templateUrl:"/assets/ts/components/wine/view/list.html"}).state("detail",{url:"/detail/:id",templateUrl:"/assets/ts/components/wine/view/detail.html",controller:"DetailCtrl",controllerAs:"detail",resolve:{details:function(service,$stateParams){return service.getCurrentProduct($stateParams.id)}}}).state("edit",{url:"/detail/:id/edit",templateUrl:"/assets/ts/components/wine/view/edit.html"})}WineApp.WineConfig=WineConfig}(WineApp||(WineApp={}));var WineApp;!function(WineApp){angular.module("app",["ui.router","wine"]).config(WineApp.WineConfig)}(WineApp||(WineApp={})),angular.module("wine",[]),angular.module("wine").controller("DetailCtrl",function(details){this.product=details,console.log(this.product)}),angular.module("wine").controller("ListCtrl",function(service){this.list=service.list}),angular.module("wine").controller("SearchCtrl",function(service,$q,$http){var _this=this;this.searchQuery=null,this.apiKey="9abd6256d560e9392d129425afe7eee9",this.service="http://services.wine.com/api/beta2/service.svc/json/catalog",this.products,this.list=service.list,this.total,this.timeout,this.showSearchResult=!1,this.offset=10,this.updateProductSearch=function(){clearTimeout(_this.timeout),_this.timeout=setTimeout(function(){service.get(_this.service+"?search="+_this.searchQuery+"&apikey="+_this.apiKey,$http,$q,"json").then(function(data){_this.products=[];var listData=data[Object.keys(data)[1]].List;listData.forEach(function(item){_this.products.push(item)}),_this.total=data[Object.keys(data)[1]].Total,_this.showSearchResult=!0})},250)},this.addProductToList=function(product){service.addProductToList(product)},this.isProductOnList=function(product){var ids=[];return _this.list.forEach(function(item){ids.push(item.Id)}),-1!==ids.indexOf(product.Id)},this.loadMoreProducts=function(){service.get(_this.service+"?search="+_this.searchQuery+"&offset="+_this.offset+"&apikey="+_this.apiKey,$http,$q,"json").then(function(data){var listData=data[Object.keys(data)[1]].List;listData.forEach(function(item){_this.products.push(item)}),_this.offset+=10})}}),angular.module("wine").service("service",function(){var _this=this;this.list=[],this.get=function(url,$http,$q,responseType){var defer=$q.defer();return $http.get(url,{responseType:responseType?responseType:"json"}).then(function(response){defer.resolve(response.data)},function(reason){defer.reject(reason)}),defer.promise},this.addProductToList=function(product){_this.list.push(product)},this.getCurrentProduct=function(currentId){var product=_this.list.filter(function(item){return item.Id==currentId});return product.pop()}});
//# sourceMappingURL=map/main.min.js.map
